<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="spms.dao.ExcelDao">

	<resultMap type="excel" id="excelResultMap">
		<id property="tno" column="TNO" />
		<result property="trcno" column="TRCNO" />
		<result property="receiveDate" column="RECEIVE_DATE" />
		<result property="deliveDate" column="DELIVE_DATE" />
		<result property="senderName" column="SENDER_NAME" />
		<result property="senderAddr" column="SENDER_ADDR" />
		<result property="senderTel1" column="SENDER_TEL1" />
		<result property="senderTel2" column="SENDER_TEL2" />
		<result property="receiverName" column="RECEIVER_NAME" />
		<result property="receiverAddr" column="RECEIVER_ADDR" />
		<result property="receiverTel1" column="RECEIVER_TEL1" />
		<result property="receiverTel2" column="RECEIVER_TEL2" />
		<result property="sendPoint" column="SEND_POINT" />
		<result property="receivePoint" column="RECEIVE_POINT" />
		<result property="packing" column="PACKING" />
		<result property="productName" column="PRODUCT_NAME" />
		<result property="count" column="COUNT" />
		<result property="size" column="SIZE" />
		<result property="weight" column="WEIGHT" />
		<result property="payment" column="PAYMENT" />
		<result property="date" column="DATE" />
	</resultMap>
  
	<delete id="delete">
		TRUNCATE `spmsdb`.`EXCEL_UPLOAD`
	</delete>
	
	<insert id="addExcel" parameterType="list">
		INSERT INTO EXCEL_UPLOAD (
		TRCNO, 
		RECEIVE_DATE, 
		DELIVE_DATE, 
		SENDER_NAME, 
		SENDER_ADDR, 
		SENDER_TEL1, 
		SENDER_TEL2, 
		RECEIVER_NAME, 
		RECEIVER_ADDR, 
		RECEIVER_TEL1, 
		RECEIVER_TEL2, 
		SEND_POINT, 
		RECEIVE_POINT, 
		PACKING, 
		PRODUCT_NAME, 
		COUNT, 
		SIZE, 
		WEIGHT, 
		PAYMENT,DATE) VALUES
		<foreach item="excel" collection="list" separator=",">
			(
			#{excel.trcno}, 
			#{excel.receiveDate}, 
			#{excel.deliveDate}, 
			#{excel.senderName}, 
			#{excel.senderAddr}, 
			#{excel.senderTel1}, 
			#{excel.senderTel2}, 
			#{excel.receiverName}, 
			#{excel.receiverAddr}, 
			#{excel.receiverTel1}, 
			#{excel.receiverTel2}, 
			#{excel.sendPoint}, 
			#{excel.receivePoint}, 
			#{excel.packing}, 
			#{excel.productName}, 
			#{excel.count}, 
			#{excel.size}, 
			#{excel.weight}, 
			#{excel.payment}, 
			now())
		</foreach>
	</insert>

	<select id="selectList" resultMap="excelResultMap">
		select
		TNO,
		TRCNO,
    RECEIVE_DATE, 
    DELIVE_DATE, 
    SENDER_NAME, 
    SENDER_ADDR, 
    SENDER_TEL1, 
    SENDER_TEL2, 
    RECEIVER_NAME, 
    RECEIVER_ADDR, 
    RECEIVER_TEL1, 
    RECEIVER_TEL2, 
    SEND_POINT, 
    RECEIVE_POINT, 
    PACKING, 
    PRODUCT_NAME, 
    COUNT, 
    SIZE, 
    WEIGHT, 
    PAYMENT,
    DATE
		from EXCEL_UPLOAD
	</select>
</mapper>