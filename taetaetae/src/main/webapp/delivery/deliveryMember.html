<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>배송목록</title>

<!-- Bootstrap -->
<link href="css/bootstrap/bootstrap.css" rel="stylesheet">
<script type="text/javascript" src="cordova.js"></script>
<script type="text/javascript" src="js/jquery-1.9.1.js"></script>
<script type="text/javascript" src="js/bootstrap.js"></script>
<script type="text/javascript" src="plugins/info.asankan.phonegap.smsplugin/www/smsplugin.js"></script>
<style type="text/css">
header {
	width: 100%;
	background: yellow;
	position: fixed;
	top: 0;
	height: 25px !important;
	z-index: 100;
}
</style>
<script>
var smsplugin = cordova.require("info.asankan.phonegap.smsplugin.smsplugin");

	$(function() {
		var listLength;
		var id;

		load_list();

	});
	

	function load_list() {
		$.getJSON(
						'../excel/ajax/deleveryMember.do',
						function(data) {
							var tel = null;
							var records = data.jsonResult.data;
							var contents = '<div id="accordion" class="ui-accordion ui-widget ui-helper-reset" role="tablist">';
							console.log("records : " + records);
							listLength = records.length;
							id = records[0].id;
							for (var i = 0; i < records.length; i++) {
								tel = records[i].receiverTel1.split("-");
								$('#accordion')
										.append(
												'<div class="panel panel-default">'
														+ '    <div class="panel-heading">'
														+ '       <h4 class="panel-title">'
														+ '         <input type="checkbox" id="'
														+ (i + 1)
														+ '" class="checkGroup" value='
														+ records[i].trcno
														+ '><a data-toggle="collapse" data-parent="#accordion" href="#'+records[i].receiverName+' ">'
														+ ' 	  '
														+ records[i].receiverName
														+ '&nbsp'
														+ records[i].receiverAddrRoad
														+ '&nbsp'
														+ records[i].receiverAddrBun
														+ '&nbsp'
														+ records[i].receiverAddrJi
														+ '&nbsp'
														+ records[i].receiverAddrName
														+ '&nbsp'
														+ '<button id="tel"><a href="tel:'+ tel[0] + tel[1] + tel[2] +'">전화걸기</a></button>'
                            + '<button id="sms"><a href="sms:'+ tel[0] + tel[1] + tel[2] +'">문자보내기</a></button>'
														+ '  </a>'
														+ ' 	      </h4>'
														+ ' 	    </div>'
														+ ' 	    <div id="'+records[i].receiverName+'" class="panel-collapse collapse in">'
														+ ' 	      <div class="panel-body">'
														+ '       수취인 :  '
														+ records[i].receiverName
														+ ' <br> '
														+ '      전화번호1 : '
														+ records[i].receiverTel1
														+ ' <br> '
														+ '      전화번호2 : '
														+ records[i].receiverTel2
														+ ' <br> '
														+ '       </div>'
														+ ' 	    </div>'
														+ ' 	  </div>');
								tels = null;
							}

							acco();
						});
	};
  
	function smsSend(number) {
		smsplugin.send(number,"sendokok");
	};
	
	
	function acco() {
		$('.collapse').collapse('hide');
	};
</script>

<style type="text/css">
header {
	width: 100%;
	background: yellow;
	position: fixed;
	top: 0;
	height: 25px !important;
	z-index: 100;
}
</style>

</head>
<body>

	<select>
		<option>배송중</option>
		<option>배송완료</option>
		<option>수취인불명</option>
		<option>주소 불확실</option>
	</select>
	<select>
		<option>도로명</option>
		<option>번지명</option>
	</select>
	<input type="button" name="버튼" value="배송처리" onclick="test()" />
	<script type="text/javascript">

		function test() {

			var values = $('input:checkbox:checked.checkGroup').map(function() {
				return this.value;
			}).get();
			console.log(values);
			console.log(typeof values);
			console.log(id);
			console.log(listLength);
			$.ajaxSettings.traditional = true;
 			$.post('../excel/stateUpdate.do', {id: id, count: listLength, updateList: values});
 			location.reload();
		};
	</script>
	<input type="button" name="버튼" value="설정"
		onclick="location.href='map.html'" />
	<div class="panel-group" id="accordion"></div>
	<button id="tel" onclick="smsSend('01047311909')">전화걸기</a></button>
</body>
</html>